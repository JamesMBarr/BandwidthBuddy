<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1015px" preserveAspectRatio="none" style="width:1037px;height:1015px;background:#FFFFFF;" version="1.1" viewBox="0 0 1037 1015" width="1037px" zoomAndPan="magnify"><defs/><g><rect fill="#DDDDDD" height="1003.7109" style="stroke:#181818;stroke-width:0.5;" width="544" x="341" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="55" x="585.5" y="19.4951">Firebase</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="77" x2="77" y1="89.9609" y2="929.1016"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="129" x2="129" y1="89.9609" y2="929.1016"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="315" x2="315" y1="89.9609" y2="929.1016"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="393" x2="393" y1="89.9609" y2="929.1016"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="646" x2="646" y1="89.9609" y2="929.1016"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="736" x2="736" y1="89.9609" y2="929.1016"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="829" x2="829" y1="89.9609" y2="929.1016"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="958" x2="958" y1="89.9609" y2="929.1016"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="53" y="86.8848">Device</text><ellipse cx="77.5" cy="56.3516" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="65.5" x2="89.5" y1="70.3516" y2="70.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="53" y="942.6348">Device</text><ellipse cx="77.5" cy="961.7109" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#181818;stroke-width:0.5;" x1="65.5" x2="89.5" y1="975.7109" y2="975.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="112" y="86.8848">User</text><ellipse cx="129.5" cy="20.8516" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M129.5,28.8516 L129.5,55.8516 M116.5,36.8516 L142.5,36.8516 M129.5,55.8516 L116.5,70.8516 M129.5,55.8516 L142.5,70.8516 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="112" y="942.6348">User</text><ellipse cx="129.5" cy="954.2109" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M129.5,962.2109 L129.5,989.2109 M116.5,970.2109 L142.5,970.2109 M129.5,989.2109 L116.5,1004.2109 M129.5,989.2109 L142.5,1004.2109 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="39" x="296" y="57.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="25" x="303" y="78.8848">App</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="39" x="296" y="928.1016"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="25" x="303" y="949.6348">App</text><rect fill="#E2E2F0" height="31.6094" style="stroke:#181818;stroke-width:0.5;" width="93" x="349" y="53.3516"/><rect fill="#E2E2F0" height="31.6094" style="stroke:#181818;stroke-width:0.5;" width="93" x="345" y="57.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="352" y="78.8848">Cloud Tasks</text><rect fill="#E2E2F0" height="31.6094" style="stroke:#181818;stroke-width:0.5;" width="93" x="349" y="928.1016"/><rect fill="#E2E2F0" height="31.6094" style="stroke:#181818;stroke-width:0.5;" width="93" x="345" y="932.1016"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="352" y="953.6348">Cloud Tasks</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="598" y="86.8848">Cloud Storage</text><path d="M628.5,36.3516 C628.5,26.3516 646.5,26.3516 646.5,26.3516 C646.5,26.3516 664.5,26.3516 664.5,36.3516 L664.5,62.3516 C664.5,72.3516 646.5,72.3516 646.5,72.3516 C646.5,72.3516 628.5,72.3516 628.5,62.3516 L628.5,36.3516 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M628.5,36.3516 C628.5,46.3516 646.5,46.3516 646.5,46.3516 C646.5,46.3516 664.5,46.3516 664.5,36.3516 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="598" y="942.6348">Cloud Storage</text><path d="M628.5,955.7109 C628.5,945.7109 646.5,945.7109 646.5,945.7109 C646.5,945.7109 664.5,945.7109 664.5,955.7109 L664.5,981.7109 C664.5,991.7109 646.5,991.7109 646.5,991.7109 C646.5,991.7109 628.5,991.7109 628.5,981.7109 L628.5,955.7109 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M628.5,955.7109 C628.5,965.7109 646.5,965.7109 646.5,965.7109 C646.5,965.7109 664.5,965.7109 664.5,955.7109 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="705" y="86.8848">Firestore</text><path d="M718.5,36.3516 C718.5,26.3516 736.5,26.3516 736.5,26.3516 C736.5,26.3516 754.5,26.3516 754.5,36.3516 L754.5,62.3516 C754.5,72.3516 736.5,72.3516 736.5,72.3516 C736.5,72.3516 718.5,72.3516 718.5,62.3516 L718.5,36.3516 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M718.5,36.3516 C718.5,46.3516 736.5,46.3516 736.5,46.3516 C736.5,46.3516 754.5,46.3516 754.5,36.3516 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="705" y="942.6348">Firestore</text><path d="M718.5,955.7109 C718.5,945.7109 736.5,945.7109 736.5,945.7109 C736.5,945.7109 754.5,945.7109 754.5,955.7109 L754.5,981.7109 C754.5,991.7109 736.5,991.7109 736.5,991.7109 C736.5,991.7109 718.5,991.7109 718.5,981.7109 L718.5,955.7109 " fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M718.5,955.7109 C718.5,965.7109 736.5,965.7109 736.5,965.7109 C736.5,965.7109 754.5,965.7109 754.5,955.7109 " fill="none" style="stroke:#181818;stroke-width:1.5;"/><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103" x="778" y="57.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="785" y="78.8848">Firebase Auth</text><rect fill="#E2E2F0" height="31.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103" x="778" y="928.1016"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="785" y="949.6348">Firebase Auth</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128" x="891" y="86.8848">External Speed Test</text><ellipse cx="958" cy="56.3516" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><polygon fill="#181818" points="954,44.3516,960,39.3516,958,44.3516,960,49.3516,954,44.3516" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128" x="891" y="942.6348">External Speed Test</text><ellipse cx="958" cy="961.7109" fill="#E2E2F0" rx="12" ry="12" style="stroke:#181818;stroke-width:0.5;"/><polygon fill="#181818" points="954,949.7109,960,944.7109,958,949.7109,960,954.7109,954,949.7109" style="stroke:#181818;stroke-width:1.0;"/><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1030" x="0" y="121.1367"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1030" y1="121.1367" y2="121.1367"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1030" y1="124.1367" y2="124.1367"/><rect fill="#EEEEEE" height="24.3516" style="stroke:#000000;stroke-width:2.0;" width="78" x="476" y="109.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="64" x="482" y="127.4561">Collection</text><path d="M5,149.3125 L5,175.3125 L150,175.3125 L150,159.3125 L140,149.3125 L5,149.3125 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M140,149.3125 L140,159.3125 L150,159.3125 L140,149.3125 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="11" y="167.8076">Runs device/mains.ts</text><polygon fill="#181818" points="946,199.0156,956,203.0156,946,207.0156,950,203.0156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="77.5" x2="952" y1="203.0156" y2="203.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="84.5" y="198.1592">Executes speed test</text><polygon fill="#181818" points="88.5,229.3672,78.5,233.3672,88.5,237.3672,84.5,233.3672" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="82.5" x2="957" y1="233.3672" y2="233.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="94.5" y="228.5107">Returns speed measurement</text><polygon fill="#181818" points="381.5,276.0703,391.5,280.0703,381.5,284.0703,385.5,280.0703" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="77.5" x2="387.5" y1="280.0703" y2="280.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="84.5" y="258.8623">Sends speed measurement</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208" x="84.5" y="275.2139">POST /storemeasurement/ [HTTPS]</text><path d="M270,293.0703 L270,319.0703 L517,319.0703 L517,303.0703 L507,293.0703 L270,293.0703 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M507,293.0703 L507,303.0703 L517,303.0703 L507,293.0703 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="226" x="276" y="311.5654">Verifies auth token and requesting user</text><path d="M267,329.4219 L267,355.4219 L519,355.4219 L519,339.4219 L509,329.4219 L267,329.4219 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M509,329.4219 L509,339.4219 L519,339.4219 L509,329.4219 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231" x="273" y="347.917">Appends user data to raw measurement</text><polygon fill="#181818" points="634.5,379.125,644.5,383.125,634.5,387.125,638.5,383.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="393.5" x2="640.5" y1="383.125" y2="383.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229" x="400.5" y="378.2686">Stores EnrichedMeasurement as a blob</text><polygon fill="#181818" points="88.5,409.4766,78.5,413.4766,88.5,417.4766,84.5,413.4766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="82.5" x2="392.5" y1="413.4766" y2="413.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="94.5" y="408.6201">Returns 202 Accepted [HTTPS]</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1030" x="0" y="442.6523"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1030" y1="442.6523" y2="442.6523"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1030" y1="445.6523" y2="445.6523"/><rect fill="#EEEEEE" height="24.3516" style="stroke:#000000;stroke-width:2.0;" width="72" x="479" y="431.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="58" x="485" y="448.9717">Ingestion</text><path d="M288,470.8281 L288,512.8281 L499,512.8281 L499,480.8281 L489,470.8281 L288,470.8281 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M489,470.8281 L489,480.8281 L499,480.8281 L489,470.8281 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="294" y="489.3232">New blob object finalized triggers</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="298" y="505.6748">/ingestmeasurement/</text><polygon fill="#181818" points="634.5,536.8828,644.5,540.8828,634.5,544.8828,638.5,540.8828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="393.5" x2="640.5" y1="540.8828" y2="540.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="400.5" y="536.0264">Requests new blob object</text><polygon fill="#181818" points="404.5,567.2344,394.5,571.2344,404.5,575.2344,400.5,571.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="398.5" x2="645.5" y1="571.2344" y2="571.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166" x="410.5" y="566.3779">Returns blob object contents</text><path d="M206,584.2344 L206,610.2344 L581,610.2344 L581,594.2344 L571,584.2344 L206,584.2344 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M571,584.2344 L571,594.2344 L581,594.2344 L571,584.2344 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="354" x="212" y="602.7295">Converts EnrichedMeasurement into ProcessedMeasurement</text><polygon fill="#181818" points="724.5,650.2891,734.5,654.2891,724.5,658.2891,728.5,654.2891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="393.5" x2="730.5" y1="654.2891" y2="654.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="400.5" y="633.0811">Adds ProcessedMeasurement to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="400.5" y="649.4326">"measurements" collection</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1030" x="0" y="683.4648"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1030" y1="683.4648" y2="683.4648"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1030" y1="686.4648" y2="686.4648"/><rect fill="#EEEEEE" height="24.3516" style="stroke:#000000;stroke-width:2.0;" width="95" x="467.5" y="672.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="81" x="473.5" y="689.7842">Visualisation</text><polygon fill="#181818" points="303.5,724.9922,313.5,728.9922,303.5,732.9922,307.5,728.9922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="129.5" x2="309.5" y1="728.9922" y2="728.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="38" x="136.5" y="724.1357">Logins</text><polygon fill="#181818" points="817.5,755.3438,827.5,759.3438,817.5,763.3438,821.5,759.3438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="315.5" x2="823.5" y1="759.3438" y2="759.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="322.5" y="754.4873">Delgates login to</text><polygon fill="#181818" points="326.5,785.6953,316.5,789.6953,326.5,793.6953,322.5,789.6953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="320.5" x2="828.5" y1="789.6953" y2="789.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="332.5" y="784.8389">Returns user</text><polygon fill="#181818" points="140.5,816.0469,130.5,820.0469,140.5,824.0469,136.5,820.0469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="134.5" x2="314.5" y1="820.0469" y2="820.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="146.5" y="815.1904">Redirects user to login page</text><polygon fill="#181818" points="724.5,846.3984,734.5,850.3984,724.5,854.3984,728.5,850.3984" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="315.5" x2="730.5" y1="850.3984" y2="850.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239" x="322.5" y="845.542">Subscribes to "measurements" collection</text><polygon fill="#181818" points="326.5,876.75,316.5,880.75,326.5,884.75,322.5,880.75" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="320.5" x2="735.5" y1="880.75" y2="880.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="332.5" y="875.8936">Returns user's measurements</text><polygon fill="#181818" points="140.5,907.1016,130.5,911.1016,140.5,915.1016,136.5,911.1016" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="134.5" x2="314.5" y1="911.1016" y2="911.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="146.5" y="906.2451">Displays measurement data</text><!--MD5=[4d9d048a134fa3aa8f8fc398fb796289]
@startuml

entity Device
actor User
participant App
box "Firebase"
collections "Cloud Tasks" as Tasks
database "Cloud Storage" as Storage
database "Firestore" as Store
participant "Firebase Auth" as Auth
end box
control "External Speed Test" as Test

==Collection==
note over Device: Runs device/mains.ts
Device -> Test: Executes speed test
Test - -> Device: Returns speed measurement
Device -> Tasks: Sends speed measurement\nPOST /storemeasurement/ [HTTPS]
note over Tasks: Verifies auth token and requesting user
note over Tasks: Appends user data to raw measurement
Tasks -> Storage: Stores EnrichedMeasurement as a blob
Tasks - -> Device: Returns 202 Accepted [HTTPS]

==Ingestion==
note over Tasks: New blob object finalized triggers\n /ingestmeasurement/
Tasks -> Storage: Requests new blob object
Storage - -> Tasks: Returns blob object contents
note over Tasks: Converts EnrichedMeasurement into ProcessedMeasurement
Tasks -> Store: Adds ProcessedMeasurement to\n"measurements" collection

==Visualisation==
User -> App: Logins
App -> Auth: Delgates login to
Auth - -> App: Returns user
App - -> User: Redirects user to login page
App -> Store: Subscribes to "measurements" collection
Store - -> App: Returns user's measurements
App -> User: Displays measurement data

@enduml

PlantUML version 1.2022.7(Mon Aug 22 18:01:30 BST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: GB
--></g></svg>